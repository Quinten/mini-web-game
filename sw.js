(()=>{var e=Object.freeze({addIcons:e=>{let t=document.createElement("canvas");t.width=1024,t.height=1024;let a=t.getContext("2d");e?e(a):(a.fillStyle="white",a.fillRect(0,0,1024,1024),a.fillStyle="lightblue",a.fillRect(256,256,512,512));let r=t.toDataURL(),s=document.createElement("link");s.rel="icon",s.type="image/png",s.href=r,document.head.appendChild(s);let o=document.createElement("link");o.rel="apple-touch-icon",o.href=r,document.head.appendChild(o);let c=document.title,n=document.querySelector("[name=description]").getAttribute("content"),d=document.body.style.background,l=document.createElement("meta");l.name="theme-color",l.content=d,document.head.appendChild(l);let i=window.location.href,p=i.replace(/[^/]+$/,""),h=[{src:r,type:"image/png",sizes:"1024x1024"}],m=document.createElement("link");m.rel="manifest",m.href="data:application/json,"+JSON.stringify({name:c,short_name:c,description:n,background_color:d,theme_color:d,display:"standalone",start_url:i,scope:p,icons:h}),document.head.appendChild(m)}});let t=["preupdate","update","postupdate","predraw","draw","postdraw"],a={preupdate:["preupdate"],update:["update"],postupdate:["postupdate"],predraw:["presave","pretransform","predraw"],draw:["save","transform","draw","restore"],postdraw:["postdraw","postrestore"]},r=e=>{let{ctx:t}=e;t.save()},s=e=>{let{ctx:t}=e;t.restore()},o={draw:{save:r,restore:s},transform:{save:r,restore:s},predraw:{presave:r,postrestore:s},pretransform:{presave:r,postrestore:s},postdraw:{presave:r,postrestore:s}},c={};t.forEach(e=>{c[e]={}}),Object.keys(a).forEach(e=>{a[e].forEach(e=>{c[e]={}})});var n=Object.freeze({systems:c,systemTypes:t,subsystemTypes:a,addComponents:e=>{Object.keys(e).forEach(r=>{t.forEach(t=>{void 0!==e[r][t]&&(c[t][r]=e[r][t],void 0!==o[t]&&Object.keys(o[t]).forEach(e=>{void 0===c[e][r]&&(c[e][r]=o[t][e])}))}),Object.keys(a).forEach(t=>{a[t].forEach(t=>{void 0!==e[r][t]&&(c[t][r]=e[r][t],void 0!==o[t]&&Object.keys(o[t]).forEach(a=>{void 0===e[r][a]&&(c[a][r]=o[t][a])}))})})})}}),d=Object.freeze({game:(t,a,r)=>{e.addIcons(r);let{systems:s,systemTypes:o,subsystemTypes:c,addComponents:d}=n;d(a);let l={},i=canvas.getContext("2d"),p=0,h=0,m=e=>{h=e-p,p=e,o.forEach(e=>{l[e]=[]}),t.system.states.forEach(a=>{t[a].state.entities.forEach(r=>{let n=t[r];Object.keys(n).forEach(d=>{let p=n[d],m={entities:t,id:r,entity:n,comp:d,component:p,stateId:a,delta:h,time:e,ctx:i};o.forEach(e=>{c[e].forEach(t=>{void 0!==s[t][d]&&l[e].push({system:s[t][d],c:m})})})})})}),o.forEach(e=>{l[e].forEach(e=>{let{system:t,c:a}=e;t(a)})}),requestAnimationFrame(m)};m(0)}});let l=["index.html"];var i=Object.freeze({start:e=>{let t=void 0===e?"mwg":e,a=e=>{let t=new Request(e,{cache:"reload"});if("cache"in t)return t;let a=new URL(e,self.location.href);return a.search+=(a.search?"&":"")+"cachebust="+Date.now(),new Request(a)};self.addEventListener("install",e=>{e.waitUntil(caches.open(t).then(e=>e.addAll(l)).then(self.skipWaiting()))}),self.addEventListener("activate",e=>{let a=[t];e.waitUntil(caches.keys().then(e=>e.filter(e=>!a.includes(e))).then(e=>Promise.all(e.map(e=>caches.delete(e)))).then(()=>self.clients.claim()))}),self.addEventListener("fetch",e=>{e.respondWith(fetch(a(e.request.url)).then(a=>(caches.open(t).then(t=>t.put(e.request.url,a.clone())),a.clone())).catch(t=>caches.match(e.request.url)))})},PRECACHE_URLS:l});let{game:p}=d,{start:h,PRECACHE_URLS:m}=Object.freeze({game:p,sw:i}).sw;m.push(...[]),h("mini-web-game")})();
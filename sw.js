(()=>{var e=Object.freeze({addIcons:e=>{let t=document.createElement("canvas");t.width=1024,t.height=1024;let a=t.getContext("2d");e?e(a):(a.fillStyle="white",a.fillRect(0,0,1024,1024),a.fillStyle="lightblue",a.fillRect(256,256,512,512));let s=t.toDataURL(),c=document.createElement("link");c.rel="icon",c.type="image/png",c.href=s,document.head.appendChild(c);let n=document.createElement("link");n.rel="apple-touch-icon",n.href=s,document.head.appendChild(n);let r=document.title,o=document.querySelector("[name=description]").getAttribute("content"),d=document.body.style.background,l=document.createElement("meta");l.name="theme-color",l.content=d,document.head.appendChild(l);let i=window.location.href,p=i.replace(/[^/]+$/,""),h=[{src:s,type:"image/png",sizes:"1024x1024"}],m=document.createElement("link");m.rel="manifest",m.href="data:application/json,"+JSON.stringify({name:r,short_name:r,description:o,background_color:d,theme_color:d,display:"standalone",start_url:i,scope:p,icons:h}),document.head.appendChild(m)}});let t=["preupdate","update","postupdate","predraw","draw","postdraw"],a={preupdate:["preupdate"],update:["update"],postupdate:["postupdate"],predraw:["pretransform","predraw"],draw:["transform","draw"],postdraw:["postdraw"]},s={},c=()=>{s={},Object.keys(a).forEach(e=>{a[e].forEach(e=>{s[e]={}})})};c();var n=Object.freeze({systems:s,systemTypes:t,subsystemTypes:a,addComponents:(e,n)=>{let r={canvas:void 0,ctx:void 0};return Object.keys(e).forEach(t=>{void 0!==e[t].canvas&&(r.canvas=e[t].canvas,r.ctx=r.canvas.getContext("2d"))}),void 0!==r.canvas||n||(["predraw","draw","postdraw"].forEach(e=>{t.splice(t.indexOf(e),1)}),c()),Object.keys(e).forEach(t=>{Object.keys(a).forEach(c=>{a[c].forEach(a=>{void 0!==e[t][a]&&(s[a][t]=e[t][a])})})}),r}}),r=Object.freeze({game:(t,a,s)=>{e.addIcons(s);let{systems:c,systemTypes:r,subsystemTypes:o,addComponents:d}=n,{canvas:l,ctx:i}=d(a),p=0,h=0,m=e=>{h=e-p,p=e;let a=[];r.forEach(s=>{t.system.states.forEach(n=>{t[n].state.entities.forEach(r=>{let d=t[r],p=Object.keys(d).some(e=>void 0!==c.transform[e]||void 0!==c.draw[e]);"draw"===s&&p&&a.push({system:e=>{i.save()},c:{}}),o[s].forEach(s=>{Object.keys(d).forEach(o=>{let p=d[o],m={entities:t,id:r,entity:d,comp:o,component:p,stateId:n,delta:h,time:e,ctx:i,canvas:l};void 0!==c[s][o]&&a.push({system:c[s][o],c:m})})}),"draw"===s&&p&&a.push({system:e=>{i.restore()},c:{}})})})}),a.forEach(e=>{let{system:t,c:a}=e;t(a)}),requestAnimationFrame(m)};m(0)}});let o=["index.html"];var d=Object.freeze({start:e=>{let t=void 0===e?"mwg":e,a=e=>{let t=new Request(e,{cache:"reload"});if("cache"in t)return t;let a=new URL(e,self.location.href);return a.search+=(a.search?"&":"")+"cachebust="+Date.now(),new Request(a)};self.addEventListener("install",e=>{e.waitUntil(caches.open(t).then(e=>e.addAll(o)).then(self.skipWaiting()))}),self.addEventListener("activate",e=>{let a=[t];e.waitUntil(caches.keys().then(e=>e.filter(e=>!a.includes(e))).then(e=>Promise.all(e.map(e=>caches.delete(e)))).then(()=>self.clients.claim()))}),self.addEventListener("fetch",e=>{e.respondWith(fetch(a(e.request.url)).then(a=>(caches.open(t).then(t=>t.put(e.request.url,a.clone())),a.clone())).catch(t=>caches.match(e.request.url)))})},PRECACHE_URLS:o});let{game:l}=r,{start:i,PRECACHE_URLS:p}=Object.freeze({game:l,sw:d}).sw;p.push(...[]),i("mini-web-game")})();